(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{TbCe:function(e,t,a){"use strict";a.r(t);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==a)return;var i,n,o=[],s=!0,r=!1;try{for(a=a.call(e);!(s=(i=a.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){r=!0,n=e}finally{try{s||null==a.return||a.return()}finally{if(r)throw n}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}var o={data:function(e){return{csrf:document.querySelector('meta[name="csrf-token"]').getAttribute("content"),editmode:!1,dialog:!1,dialogDelete:!1,search:"",permbisnis:[],valid:!0,editedItem:{id:"",kantor_id:"",namafile:"",status_id:""},file:null,file_memo:null,pesaneror:[],nameRules:[function(e){return!!e||"Nama File Belum Diisi"}],menu1:!1,menu2:!1,dateFormatted:e.formatDate(new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)),tgl_permohonan:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),tgl_permohonanRules:[function(e){return!!e||"Tanggal realisasi belum diisi"}],form:new Form({id:"",kantor_id:"",namafile:"",tgl_permohonan:"",file:""})}},computed:{headers:function(){var e=[{text:"No",value:"index",align:"center",sortable:!1},{text:"Kantor",value:"nama_kantor",align:"start"},{text:"Nama File",value:"namafile"},{text:"Tanggal Permohonan",value:"tgl_permohonan"},{text:"Tanggal Setuju Bisnis",value:"tgl_setujutolak"},{text:"Tanggal Proses Operasional",value:"tgl_acc"},{text:"Tanggal Selesai",value:"tgl_selesai"},{text:"Status",value:"statuspermohonan"}];return e.push({text:"File Permohonan",value:"file",sortable:!1,align:"center"}),(this.$gate.isAdmin()||this.$gate.isBisnis())&&(e.push({text:"File Memo",value:"file_memo",sortable:!1,align:"center"}),e.push({text:"Update Status",value:"edit",sortable:!1,align:"center"})),this.$gate.isAdmin()&&e.push({text:"Hapus",value:"actions",sortable:!1}),e},computedDateFormatted:function(){return this.formatDate(this.tgl_permohonan)},formTitle:function(){return-1===this.editedIndex?"New Item":"Edit Item"}},watch:{tgl_permohonan:function(e){this.dateFormatted=this.formatDate(this.tgl_permohonan)},dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()}},created:function(){this.$Progress.start(),this.initialize(),this.$Progress.finish()},methods:{getColor:function(e){return"Selesai"===e?"green":"Ditolak"===e?"red":"orange"},pencetKeyboard:function(e){var t=(e=e||window.event).which?e.which:e.keyCode;if(191!==t&&220!==t)return!0;e.preventDefault()},formatDate:function(e){if(!e)return null;var t=i(e.split("-"),3),a=t[0],n=t[1],o=t[2];return"".concat(o,"/").concat(n,"/").concat(a)},parseDate:function(e){if(!e)return null;var t=i(e.split("/"),3),a=t[0],n=t[1],o=t[2];return"".concat(o,"-").concat(n.padStart(2,"0"),"-").concat(a.padStart(2,"0"))},initialize:function(){var e=this;this.$Progress.start(),(this.$gate.isAdmin()||this.$gate.isPelayanan()||this.$gate.isBisnis())&&axios.get("api/permbisnis").then((function(t){e.permbisnis=t.data.data,e.editedItem.kantor_id=e.$kantor_id})),this.$Progress.finish()},editModal:function(e){this.editmode=!0,$("#addNew").modal("show"),this.editedItem.id=e.id,this.editedItem.kantor_id=this.$kantor_id,this.editedItem.status_id=e.status_id,this.editedItem.namafile=e.namafile},newModal:function(){this.editmode=!1,$("#addNew").modal("show"),this.$refs.form.reset(),this.editedItem.namafile="",this.pesaneror=""},createUser:function(){var e=this;this.$refs.form.validate(),this.$Progress.start();var t=new FormData;t.set("kantor_id",this.editedItem.kantor_id),t.set("namafile",this.editedItem.namafile),t.set("tgl_permohonan",this.tgl_permohonan),t.set("file",this.file),t.set("status_id",5),axios.post("api/permbisnis",t,{headers:{"content-type":"multipart/form-data"}}).then((function(t){$("#addNew").modal("hide"),Toast.fire({icon:"success",title:t.data.message}),e.$Progress.finish(),e.initialize()})).catch((function(e){for(var t=e.response.data.errors,a=0,n=Object.entries(t);a<n.length;a++){var o=i(n[a],2),s=(o[0],o[1]);Toast.fire({icon:"error",title:s})}}))},downloadFile:function(e,t){axios({url:"api/permbisnis/download/"+e,method:"GET",responseType:"blob"}).then((function(e){var a=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");i.href=a,i.setAttribute("download","tabfile.zip"),i.download=t,document.body.appendChild(i),i.click()})).catch((function(){Swal.fire("Gagal Download!","File tidak ada...","warning")}))},downloadFileMemo:function(e,t){axios({url:"api/permbisnis/filememo/"+e,method:"GET",responseType:"blob"}).then((function(e){var a=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");i.href=a,i.setAttribute("download","tabfile.zip"),i.download=t,document.body.appendChild(i),i.click()})).catch((function(){Swal.fire("Gagal Download!","File Memo belum diupload.","warning")}))},updateUser:function(){var e=this;this.$refs.form.validate(),this.$Progress.start();var t=new FormData;t.set("namafile",this.editedItem.namafile),this.$gate.isBisnis()&&(t.set("tgl_setujutolak",this.tgl_permohonan),t.set("file_memo",this.file)),this.$gate.isAdmin()&&(t.set("tgl_acc",this.tgl_permohonan),t.set("tgl_selesai",this.tgl_permohonan),t.set("file_spk",this.file)),t.set("status_id",this.editedItem.status_id),t.set("kantor_id",this.editedItem.kantor_id),t.append("_method","PUT"),axios.post("api/permbisnis/"+this.editedItem.id,t,{headers:{accept:"application/json","Accept-Language":"en-US,en;q=0.8","content-type":"multipart/form-data"}}).then((function(t){$("#addNew").modal("hide"),5===t.data.data?Swal.fire("Gagal Update!","Status belum di setujui","warning"):Toast.fire({icon:"success",title:t.data.message}),e.$Progress.finish(),e.initialize()})).catch((function(t){console.log(t),e.$Progress.fail()}))},deleteUser:function(e){var t=this;Swal.fire({title:"Yakin dihapus?",text:"Jika dihapus data hilang!",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!"}).then((function(a){a.value&&t.form.delete("api/permbisnis/"+e).then((function(){Swal.fire("Dihapus!","Data telah dihapus.","success"),t.initialize()})).catch((function(e){Swal.fire("Failed!",e.message,"warning")}))}))}}},s=a("KHd+"),r=Object(s.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-container",{attrs:{fluid:""}},[a("v-row",{staticClass:"justify-content-md-center",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"11"}},[e.$gate.isAdmin()||e.$gate.isPelayanan()||e.$gate.isBisnis()?a("v-card",{staticClass:"pa-2 mx-auto"},[a("v-toolbar",{attrs:{src:"images/banner-biru-pelayanan.jpg",dark:"",shaped:""}},[a("v-toolbar-title",[e._v(" Permohonan ke Divisi Bisnis ")]),e._v(" "),a("v-spacer"),e._v(" "),e.$gate.isAdmin()||e.$gate.isPelayanan()?a("v-btn",{attrs:{small:"",color:"indigo",dark:""},on:{click:e.newModal}},[a("v-icon",[e._v("mdi-file-upload")]),e._v(" Upload File\n            ")],1):e._e()],1),e._v(" "),a("div",{staticClass:"card-body table-responsive p-0"},[a("v-data-table",{staticClass:"elevation-3",attrs:{headers:e.headers,items:e.permbisnis,search:e.search,justify:"center",dense:""},scopedSlots:e._u([{key:"footer.prepend",fn:function(){return[a("v-btn",{staticClass:"ma-2",attrs:{color:"success",dark:"",small:""},on:{click:function(t){return e.initialize()}}},[e._v("\n                  Refresh\n                  "),a("v-icon",{attrs:{right:"",dark:""}},[e._v(" mdi-reload ")])],1)]},proxy:!0},{key:"item.index",fn:function(t){var a=t.index;return[e._v("\n                "+e._s(a+1)+"\n              ")]}},{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),e._v(" "),a("v-spacer"),e._v(" "),a("v-spacer"),e._v(" "),a("v-spacer"),e._v(" "),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Cari File","single-line":"","hide-details":"",loading:"grey"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0},{key:"item.statuspermohonan",fn:function(t){var i=t.item;return[a("v-chip",{attrs:{color:e.getColor(i.statuspermohonan)}},[e._v("\n                  "+e._s(i.statuspermohonan)+"\n              ")])]}},{key:"item.file",fn:function(t){var i=t.item;return[a("v-card-actions",{staticClass:"justify-center"},[a("v-icon",{staticClass:"mr-4",attrs:{small:"",color:"blue"},on:{click:function(t){return e.downloadFile(i.id,i.file)}}},[e._v("\n                    mdi-download\n                  ")])],1)]}},{key:"item.file_memo",fn:function(t){var i=t.item;return[a("v-card-actions",{staticClass:"justify-center"},[a("v-icon",{staticClass:"mr-4",attrs:{small:"",color:"blue"},on:{click:function(t){return e.downloadFileMemo(i.id,i.file_memo)}}},[e._v("\n                    mdi-download\n                  ")])],1)]}},{key:"item.edit",fn:function(t){var i=t.item;return[a("v-card-actions",{staticClass:"justify-center"},[a("v-icon",{attrs:{small:"",color:"green"},on:{click:function(t){return e.editModal(i)}}},[e._v("\n                    mdi-pencil\n                  ")])],1)]}},{key:"item.actions",fn:function(t){var i=t.item;return[a("v-icon",{staticClass:"mr-4",attrs:{small:"",color:"red",right:""},on:{click:function(t){return e.deleteUser(i.id)}}},[e._v("\n                  mdi-delete\n                ")])]}}],null,!1,3950888169)})],1)],1):e._e()],1)],1),e._v(" "),e.$gate.isAdmin()||e.$gate.isPelayanan()||e.$gate.isBisnis()?e._e():a("div",[a("not-found")],1),e._v(" "),a("div",{staticClass:"modal fade",attrs:{id:"addNew",tabindex:"-1",role:"dialog","aria-labelledby":"addNew","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{directives:[{name:"show",rawName:"v-show",value:!e.editmode,expression:"!editmode"}],staticClass:"modal-title"},[e._v("Upload File")]),e._v(" "),a("h5",{directives:[{name:"show",rawName:"v-show",value:e.editmode,expression:"editmode"}],staticClass:"modal-title"},[e._v("Update Status")]),e._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])]),e._v(" "),a("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(t){t.preventDefault(),e.editmode?e.updateUser():e.createUser()}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("div",{staticClass:"modal-body"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.editedItem.kantor_id,expression:"editedItem.kantor_id"}],attrs:{type:"hidden",name:"kantor_id"},domProps:{value:e.editedItem.kantor_id},on:{input:function(t){t.target.composing||e.$set(e.editedItem,"kantor_id",t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.editedItem.status_id,expression:"editedItem.status_id"}],attrs:{type:"hidden",name:"status_id"},domProps:{value:e.editedItem.status_id},on:{input:function(t){t.target.composing||e.$set(e.editedItem,"status_id",t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.csrf,expression:"csrf"}],attrs:{type:"hidden",name:"_token"},domProps:{value:e.csrf},on:{input:function(t){t.target.composing||(e.csrf=t.target.value)}}}),e._v(" "),a("div",{staticClass:"form-group input-group"},[a("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[a("v-text-field",{attrs:{rules:e.nameRules,name:"namafile",label:"Surat Permohonan",placeholder:"Nama File: surat permohonan",outlined:"",required:"",dense:"","prepend-icon":"mdi-file"},on:{keydown:function(t){return e.pencetKeyboard(t)}},model:{value:e.editedItem.namafile,callback:function(t){e.$set(e.editedItem,"namafile",t)},expression:"editedItem.namafile"}}),e._v(" "),a("has-error",{attrs:{form:e.form,field:"namafile"}}),e._v(" "),[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[a("v-menu",{ref:"menu1",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,n=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{rules:e.tgl_permohonanRules,label:"Tanggal",placeholder:"Tanggal","prepend-icon":"mdi-calendar",outlined:"",required:"",readonly:"",dense:""},on:{blur:function(t){e.tgl_permohonan=e.parseDate(e.dateFormatted)}},model:{value:e.dateFormatted,callback:function(t){e.dateFormatted=t},expression:"dateFormatted"}},"v-text-field",n,!1),i))]}}]),model:{value:e.menu1,callback:function(t){e.menu1=t},expression:"menu1"}},[e._v(" "),a("v-date-picker",{attrs:{elevation:"15","year-icon":"calendar-blank",locale:"id-ID"},on:{input:function(t){e.menu1=!1}},model:{value:e.tgl_permohonan,callback:function(t){e.tgl_permohonan=t},expression:"tgl_permohonan"}})],1)],1)],1)],e._v(" "),a("has-error",{attrs:{form:e.form,field:"tgl_permohonan"}}),e._v(" "),[a("v-file-input",{attrs:{color:"deep-purple accent-4",counter:"",label:"Upload File",placeholder:"Ambil File","prepend-icon":"mdi-paperclip",outlined:"",dense:"","show-size":"",accept:".pdf"},scopedSlots:e._u([{key:"selection",fn:function(t){var i=t.index,n=t.text;return[i<2?a("v-chip",{attrs:{color:"deep-purple accent-4",dark:"",label:"",small:""}},[e._v("\n                          "+e._s(n)+"\n                        ")]):2===i?a("span",{staticClass:"text-overline grey--text text--darken-3 mx-2"},[e._v("\n                          +"+e._s(e.files.length-2)+" File(s)\n                        ")]):e._e()]}}]),model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],e._v(" "),a("has-error",{attrs:{form:e.form,field:"file"}}),e._v(" "),[a("v-radio-group",{attrs:{mandatory:!1,row:"","prepend-icon":"mdi-format-list-bulleted-type"},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",[a("strong",{staticClass:"text-h6 text-bold"},[e._v("Status :")])])]},proxy:!0}]),model:{value:e.editedItem.status_id,callback:function(t){e.$set(e.editedItem,"status_id",t)},expression:"editedItem.status_id"}},[e._v(" "),e.$gate.isBisnis()?a("v-radio",{attrs:{label:"Disetujui",value:"6"}}):e._e(),e._v(" "),e.$gate.isAdmin()?a("v-radio",{attrs:{label:"Disetujui",value:"7"}}):e._e(),e._v(" "),e.$gate.isAdmin()||e.$gate.isBisnis()?a("v-radio",{attrs:{label:"Ditolak",value:"3"}}):e._e(),e._v(" "),e.$gate.isAdmin()?a("v-radio",{attrs:{label:"Selesai",value:"4"}}):e._e()],1)]],2)],1)]),e._v(" "),a("div",{staticClass:"modal-footer"},[a("v-btn",{attrs:{color:"error",elevation:"2",type:"button","data-dismiss":"modal"}},[a("v-icon",[e._v("mdi-file-cancel")]),e._v("\n                Batal\n              ")],1),e._v(" "),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.editmode,expression:"editmode"}],attrs:{color:"success",elevation:"2",type:"submit"}},[a("v-icon",[e._v("mdi-pencil")]),e._v("\n                Update\n              ")],1),e._v(" "),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.editmode,expression:"!editmode"}],attrs:{color:"primary",elevation:"2",type:"submit"}},[a("v-icon",[e._v("mdi-file-upload")]),e._v("\n                Upload\n              ")],1)],1)])],1)])])],1)],1)}),[],!1,null,null,null);t.default=r.exports}}]);
//# sourceMappingURL=31.ebox.js.map